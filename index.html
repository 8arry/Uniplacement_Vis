<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>University Placement Strategic Dashboard</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Loading Dashboard...</p>
    </div>
  </div>

  <!-- Onboarding Tips -->
  <div id="onboarding-tips" class="onboarding-panel" style="display: none;">
    <button class="onboarding-close" id="close-onboarding" title="Close tips">✕</button>
    <div class="onboarding-content">
      <h3>Quick Tips</h3>
      <ul>
        <li><strong>View 1:</strong> Drag the CGPA slider to filter all views</li>
        <li><strong>View 2:</strong> Adjust sample size for performance; use filters to focus</li>
        <li><strong>View 3:</strong> Click a college bar to highlight its students in View 2</li>
        <li><strong>View 4:</strong> Hover on violins for detailed statistics</li>
      </ul>
      <label class="dont-show-again">
        <input type="checkbox" id="dont-show-tips"> Don't show again
      </label>
    </div>
  </div>

  <!-- Theme Toggle -->
  <input type="checkbox" id="grayscale-toggle" class="grayscale-toggle" aria-label="Toggle grayscale mode">
  <header>
    <h1>University Placement Strategic Dashboard</h1>
    <p class="subtitle">Analyzing Key Success Factors for Student Placement</p>

    <div class="theme-toggle">
      <label for="grayscale-toggle" class="toggle-label">
        <span class="toggle-text">Grayscale</span>
        <span class="toggle-switch" aria-hidden="true"></span>
      </label>

      <!-- This now toggles 3-row <-> 2-row layout -->
      <button id="swap-views-btn" class="swap-views-btn" type="button" aria-label="Toggle between 2-row and 3-row layout">
        Toggle layout
      </button>
    </div>
  </header>

  <!-- Key Insights Summary Cards -->
  <div class="insights-panel" id="insights-panel">
    <div class="insight-card">
      <div class="insight-value" id="insight-total">-</div>
      <div class="insight-label">Total Students</div>
    </div>
    <div class="insight-card highlight-green">
      <div class="insight-value" id="insight-placement-rate">-</div>
      <div class="insight-label">Placement Rate</div>
    </div>
    <div class="insight-card highlight-blue">
      <div class="insight-value" id="insight-internship-rate">-</div>
      <div class="insight-label">With Internship → Placed</div>
    </div>
    <div class="insight-card highlight-orange">
      <div class="insight-value" id="insight-no-internship-rate">-</div>
      <div class="insight-label">No Internship → Placed</div>
    </div>
    <div class="insight-card">
      <div class="insight-value" id="insight-avg-cgpa">-</div>
      <div class="insight-label">Avg CGPA (Placed)</div>
    </div>
    <button id="reset-filters-btn" class="reset-btn" title="Reset all filters">
      ↺ Reset Filters
    </button>
  </div>

  <!-- Filter Status Panel -->
  <div class="status-panel" id="status-panel" role="status" aria-live="polite" aria-label="Current filter status">
    <div class="status-item">
      <span class="status-label" id="records-label">Records:</span>
      <span class="status-value" id="status-records" aria-labelledby="records-label">0 / 0</span>
    </div>
    <div class="status-item">
      <span class="status-label" id="cgpa-label">CGPA Range:</span>
      <span class="status-value" id="status-cgpa" aria-labelledby="cgpa-label">4.0 - 11.0</span>
    </div>
    <div class="status-item">
      <span class="status-label" id="sample-size-label">Scatter Sample:</span>
      <span class="status-value" id="status-sample" aria-labelledby="sample-size-label">5%</span>
    </div>
    <div class="status-item" id="status-selection-container" style="display: none;">
      <span class="status-label" id="selection-label">Selected:</span>
      <span class="status-value" id="status-selection" aria-labelledby="selection-label"><span class="selection-indicator" aria-hidden="true"></span><span id="status-selection-text">None</span></span>
      <button class="clear-selection-btn" id="clear-selection-btn" title="Clear selection" aria-label="Clear college selection">✕</button>
    </div>
  </div>

  <!-- Start in the ORIGINAL 3-row layout -->
  <main class="dashboard layout-2rows" id="dashboard">
    <!-- View 1 -->
    <section class="chart-container" id="view1-container" role="region" aria-labelledby="view1-title">
      <h2 id="view1-title">View 1: CGPA Distribution by Placement Status</h2>
      <div id="stacked-bar-chart" role="img" aria-label="Stacked bar chart showing CGPA distribution by placement status"></div>

      <div class="slider-container" role="group" aria-label="CGPA range filter">
        <label id="cgpa-range-label">CGPA Range:</label>
        <span id="range-min" aria-hidden="true">4.0</span>
        <div class="range-slider">
          <div class="range-track"></div>
          <div class="range-selected"></div>
          <input type="range" id="cgpa-slider-min" min="4" max="11" step="0.5" value="4"
                 aria-label="Minimum CGPA" aria-valuemin="4" aria-valuemax="11" aria-valuenow="4">
          <input type="range" id="cgpa-slider-max" min="4" max="11" step="0.5" value="11"
                 aria-label="Maximum CGPA" aria-valuemin="4" aria-valuemax="11" aria-valuenow="11">
        </div>
        <span id="range-max" aria-hidden="true">11.0</span>
      </div>
      <!-- Empty state message -->
      <div id="view1-empty" class="empty-state" style="display: none;">
        <p>No data matches the current filter</p>
      </div>
    </section>

    <!-- View 2 -->
    <section class="chart-container" id="view2-container" role="region" aria-labelledby="view2-title">
      <h2 id="view2-title">View 2: IQ vs CGPA <span id="view2-subtitle" class="chart-subtitle">(Color: Internship, Shape: Placement)</span></h2>
      
      <!-- Filter Controls -->
      <div class="chart-controls">
        <div class="control-group">
          <label for="placement-filter">Show:</label>
          <select id="placement-filter" aria-label="Filter by placement status">
            <option value="all">All Students</option>
            <option value="placed">Placed Only</option>
            <option value="not-placed">Not Placed Only</option>
          </select>
        </div>
        <div class="control-group">
          <label for="internship-filter">Internship:</label>
          <select id="internship-filter" aria-label="Filter by internship status">
            <option value="all">All</option>
            <option value="yes">Has Internship</option>
            <option value="no">No Internship</option>
          </select>
        </div>
      </div>
      
      <div id="scatter-plot" role="img" aria-label="Scatter plot showing IQ versus CGPA, color indicates internship status, shape indicates placement status"></div>

      <div class="slider-container" role="group" aria-label="Sample size control">
        <label id="sample-label">Sample size:</label>
        <div class="range-slider single-range">
          <div class="range-track"></div>
          <div class="range-selected" id="scatter-range-selected"></div>
          <input type="range" id="scatter-sample-slider" min="1" max="100" step="1" value="5"
                 aria-label="Sample percentage" aria-valuemin="1" aria-valuemax="100" aria-valuenow="5">
        </div>
        <span id="scatter-percent" aria-live="polite">5%</span>
      </div>
      <!-- Empty state message -->
      <div id="view2-empty" class="empty-state" style="display: none;">
        <p>No data points to display</p>
      </div>
    </section>

    <!-- View 3 -->
    <section class="chart-container" id="view3-container" role="region" aria-labelledby="view3-title">
      <h2 id="view3-title">View 3: Top Performing Colleges <span id="view3-subtitle" class="chart-subtitle"></span></h2>
      
      <!-- Sort and Search Controls -->
      <div class="chart-controls">
        <div class="control-group">
          <label for="sort-select">Sort by:</label>
          <select id="sort-select" aria-label="Sort colleges by">
            <option value="count">Placement Count</option>
            <option value="rate">Placement Rate (%)</option>
          </select>
        </div>
        <div class="control-group">
          <label for="college-search">Search:</label>
          <input type="text" id="college-search" placeholder="College ID..." aria-label="Search for college by ID">
          <button id="clear-search-btn" class="clear-search-btn" title="Clear search" aria-label="Clear search" style="display: none;">✕</button>
        </div>
      </div>
      
      <div id="bar-chart" role="img" aria-label="Horizontal bar chart showing top colleges by placement count"></div>
      <!-- Empty state message -->
      <div id="view3-empty" class="empty-state" style="display: none;">
        <p>No placed students in the current filter range</p>
      </div>
    </section>

    <!-- View 4 -->
    <section class="chart-container" id="view4-container" role="region" aria-labelledby="view4-title">
      <h2 id="view4-title">View 4: Skills Distribution (Placed Students)</h2>
      <div id="box-plot" role="img" aria-label="Violin plot showing distribution of soft skills scores for placed students"></div>
      <!-- Empty state message -->
      <div id="view4-empty" class="empty-state" style="display: none;">
        <p>No placed students to compare</p>
      </div>
    </section>
  </main>

  <!-- Tooltip -->
  <div id="tooltip" class="tooltip"></div>

  <!-- Scripts -->
  <script src="js/charts/stackedBarChart.js"></script>
  <script src="js/charts/scatterPlot.js"></script>
  <script src="js/charts/horizontalBarChart.js"></script>
  <script src="js/charts/boxPlot.js"></script>
  <script src="js/main.js"></script>
</body>

</html>